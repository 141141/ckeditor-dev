<div id="editor1">
	<figure class="image image-caption-top"><img alt="Test" width="145" height="217" src="http://placekitten.com/200/300" /><figcaption>Test caption</figcaption></figure>
	<div class="embed-titled" data-oembed-url="https://www.flickr.com/photos/polandmfa/7005560084"><a data-flickr-embed="true" href="https://www.flickr.com/photos/polandmfa/7005560084/" title="Wrocław, Hala Stulecia / Centennial Hall in Wrocław by PolandMFA, on Flickr"><img src="https://farm8.staticflickr.com/7241/7005560084_699996eab4_b.jpg" width="100%" alt="Wrocław, Hala Stulecia / Centennial Hall in Wrocław" /></a><script async="" src="https://embedr.flickr.com/assets/client-code.js" charset="utf-8"></script></div>
<pre class="comments-hidden">
	<code class="language-javascript">/**
 * Creates a {@link CKEDITOR.style} subclass and registers it in the style system.
 * Registered class will be used as a handler for a style of this type. This allows
 * to extend the styles system, which by default uses only the {@link CKEDITOR.style}, with
 * new functionality. Registered classes are accessible in the {@link CKEDITOR.style.customHandlers}.
 *
 * ### The Style Class Definition
 *
 * The definition object is used to override properties in a prototype inherited
 * from the {@link CKEDITOR.style} class. It must contain a `type` property which is
 * a name of the new type and therefore it must be unique. The default style types
 * ({@link CKEDITOR#STYLE_BLOCK STYLE_BLOCK}, {@link CKEDITOR#STYLE_INLINE STYLE_INLINE},
 * and {@link CKEDITOR#STYLE_OBJECT STYLE_OBJECT}) are integers, but for easier identification
 * it is recommended to use strings as custom type names.
 *
 * Besides `type`, the definition may contain two more special properties:
 *
 *  * `setup {Function}` &ndash; An optional callback executed when a style instance is created.
 * Like the style constructor, it is executed in style context and with the style definition as an argument.
 *  * `assignedTo {Number}` &ndash; Can be set to one of the default style types. Some editor
 * features like the Styles drop-down assign styles to one of the default groups based on
 * the style type. By using this property it is possible to notify them to which group this
 * custom style should be assigned. It defaults to the {@link CKEDITOR#STYLE_OBJECT}.
 *
 * Other properties of the definition object will just be used to extend the prototype inherited
 * from the {@link CKEDITOR.style} class. So if the definition contains an `apply` method, it will
 * override the {@link CKEDITOR.style#apply} method.
 *
 * ### Usage
 *
 * Registering a basic handler:
 *
 *		var styleClass = CKEDITOR.style.addCustomHandler( {
 *			type: 'custom'
 *		} );
 *
 *		var style = new styleClass( { ... } );
 *		style instanceof styleClass; // -> true
 *		style instanceof CKEDITOR.style; // -> true
 *		style.type; // -> 'custom'
 *
 * The {@link CKEDITOR.style} constructor used as a factory:
 *
 *		var styleClass = CKEDITOR.style.addCustomHandler( {
 *			type: 'custom'
 *		} );
 *
 *		// Style constructor accepts style definition (do not confuse with style class definition).
 *		var style = new CKEDITOR.style( { type: 'custom', attributes: ... } );
 *		style instanceof styleClass; // -> true
 *
 * Thanks to that, integration code using styles does not need to know
 * which style handler it should use. It is determined by the {@link CKEDITOR.style} constructor.
 *
 * Overriding existing {@link CKEDITOR.style} methods:
 *
 *		var styleClass = CKEDITOR.style.addCustomHandler( {
 *			type: 'custom',
 *			apply: function( editor ) {
 *				console.log( 'apply' );
 *			},
 *			remove: function( editor ) {
 *				console.log( 'remove' );
 *			}
 *		} );
 *
 *		var style = new CKEDITOR.style( { type: 'custom', attributes: ... } );
 *		editor.applyStyle( style ); // logged 'apply'
 *
 *		style = new CKEDITOR.style( { element: 'img', attributes: { 'class': 'foo' } } );
 *		editor.applyStyle( style ); // style is really applied if image was selected
 *
 * ### Practical Recommendations
 *
 * The style handling job, which includes such tasks as applying, removing, checking state, and
 * checking if a style can be applied, is very complex. Therefore without deep knowledge
 * about DOM and especially {@link CKEDITOR.dom.range ranges} and {@link CKEDITOR.dom.walker DOM walker} it is impossible
 * to implement a completely custom style handler able to handle block, inline, and object type styles.
 * However, it is possible to customize the default implementation by overriding default methods and
 * reusing them.
 *
 * The only style handler which can be implemented from scratch without huge effort is a style
 * applicable to objects ([read more about types](http://docs.ckeditor.com/#!/guide/dev_styles-section-style-types)).
 * Such style can only be applied when a specific object is selected. An example implementation can
 * be found in the [widget plugin](https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/widget/plugin.js).
 *
 * When implementing a style handler from scratch at least the following methods must be defined:
 *
 * * {@link CKEDITOR.style#apply apply} and {@link CKEDITOR.style#remove remove},
 * * {@link CKEDITOR.style#checkElementRemovable checkElementRemovable} and
 * {@link CKEDITOR.style#checkElementMatch checkElementMatch} &ndash; Note that both methods reuse the same logic,
 * * {@link CKEDITOR.style#checkActive checkActive} &ndash; Reuses
 * {@link CKEDITOR.style#checkElementMatch checkElementMatch},
 * * {@link CKEDITOR.style#toAllowedContentRules toAllowedContentRules} &ndash; Not required, but very useful in
 * case of a custom style that has to notify the {@link CKEDITOR.filter} which rules it allows when registered.
 *
 * @since 4.4
 * @static
 * @member CKEDITOR.style
 * @param definition The style class definition.
 * @returns {CKEDITOR.style} The new style class created for the provided definition.
 */
CKEDITOR.style.addCustomHandler = function( definition ) {
	var styleClass = function( styleDefinition ) {
		this._ = {
			definition: styleDefinition
		};

		if ( this.setup )
			this.setup( styleDefinition );
	};

	styleClass.prototype = CKEDITOR.tools.extend(
		// Prototype of CKEDITOR.style.
		CKEDITOR.tools.prototypedCopy( CKEDITOR.style.prototype ),
		// Defaults.
		{
			assignedTo: CKEDITOR.STYLE_OBJECT
		},
		// Passed definition - overrides.
		definition,
		true
	);

	this.customHandlers[ definition.type ] = styleClass;

	return styleClass;
};
</code></pre>

</div>

<script>

CKEDITOR.replace( 'editor1', {
	width: 1000,
	height: 1000
} );</script>
